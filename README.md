Ported to python3 version of original file taken from of xc (all creadits goes to this guy):
https://bitbucket.org/emre1393
